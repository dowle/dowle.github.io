---
title: "PHP7新特性"
date: 2020-08-12T10:55:02+08:00
tags: ["PHP"]
categories: ["PHP"]
draft: false
---
## PHP7与PHP5的性能比较
*注：因为对PHP内核不了解，信息来源于网上。*  
PHP7比PHP5快3倍以上。
本质上来说就是对zend 引擎的优化，减少内存分配次数，多使用栈内存，缓存数组hash值，字符串解析成参数改为宏展开，使用大块连续内存代替小块碎片内存等。  

具体原因是： 
1. 存储变量的结构体变小，尽量使结构体里成员共用内存空间，减少引用，这样内存占用降低，变量的操作速度得到提升。
2. 字符串结构体的改变，字符串信息和数据本身原来是分成两个独立内存块存放，php7尽量将它们存入同一块内存，提升了cpu缓存命中率。
3. 数组结构的改变，数组元素和hash映射表在php5中会存入多个内存块，php7尽量将它们分配在同一块内存里，降低了内存占用、提升了cpu缓存命中率。
4. 改进了函数的调用机制，通过对参数传递环节的优化，减少一些指令操作，提高了执行效率。

## PHP7的新特征
*注：只记录了个人会使用的特征。*  
1. null合并运算符  
$data["key"] ?? ""  
2. 常量数组  
可以通过define定义数组, define("XXX_ARRAY", [1, 2, 3])  
3. 错误处理  
PHP 7 改变了大多数错误的报告方式。不同于 PHP 5 的传统错误报告机制，现在大多数错误被作为 Error 异常抛出。可以被try catch捕获，没有则被 set_exception_handler处理，否则按传统方式处理，抛出一个fatal错误。Error异常与Exception同级，可以通过Error或Throwable捕获。 
4. 参数的标量类型与返回值类型申明