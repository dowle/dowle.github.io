---
title: "io模型详解（转载）"
date: 2020-06-15T18:33:19+08:00
tags: ["Linux", "io"]
categories: ["Linux"]
draft: false
---
## I/O介绍
I/O通常有内存IO、网络I/O、磁盘I/O等，但我们通常说的是网络I/O以及磁盘I/O。网络I/O：本质是socket读取。

每次I/O请求，都会有两个阶段组成： 第一步：等待数据，即数据从磁盘到内核内存；将数据从磁盘文件先加载到内核内存空间（缓冲区），等待数据准备完成，时间较长。第二步：复制数据，即数据内核内存到进程内存；将数据从内核缓冲复制到用户空间的进程内存中，时间较短。

## I/O模型名词介绍
I/O模型名词主要包括阻塞、非阻塞、同步、异步。
#### 阻塞与非阻塞
阻塞和非阻塞指的是执行一个操作时等操作结束再返回结果，还是马上返回结果。**强调用户线程是否被系统挂起**  
**阻塞**：指IO操作需要彻底完成后才返回到用户空间，调用结果返回之前，调用者被挂起（当前线程进入非可执行状态，在这个状态，CPU不会分配时间片，线程暂停运行）只有到到结果才进入活动状态;  
**非阻塞**：指I/O操作被调用后立即返回给用户一个状态值，无需等到I/O操作彻底完成，最终的调用结果返回之前，调用者不会被挂起；  
*例子*：你在银行排号取钱，排号后你一直等在哪里，不做其他事情，直到该你取钱，则叫阻塞；如果你排号后就打电话去了，然后一段时间后来看是否到你了，则叫非阻塞，你没有被挂起，可以做其他事情。
#### 同步与异步
同步/异步关注的是消息通信机制，**强调消息通信机制**  
**同步**：调用者等待被调用者返回消息，才能继续执行。  
**异步**：被调用者通过状态、通知或回调机制主动通知调用者被调用者的运行状态。  
*例子*：上面的银行排号问题，如果你一直等在哪里，直到到你取钱，叫做同步阻塞；如果你打电话（做其他事情），然后隔一段时间就来看，是否到你了，就叫做同步非阻塞；如果变成了到你了，给你发短信通知你，则叫做异步非阻塞。

## I/O模型类型
I/O模型主要分为以下5类：
1. 阻塞型
2. 非阻塞型
3. io复用型
4. 信号驱动型io
5. 异步io  
#### 阻塞io
![阻塞io](/images/linux/阻塞io.png)

#### 非阻塞io
![非阻塞io](/images/linux/非阻塞io.jpg)

#### io复用
![io复用](/images/linux/io复用.png)

#### 信号驱动io
![信号驱动io](/images/linux/信号驱动io.jpg)

#### 异步io
![异步io](/images/linux/异步io.jpg)

#### 总结
![总结](/images/linux/总结.jpg)
